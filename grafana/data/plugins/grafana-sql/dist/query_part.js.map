{"version":3,"sources":["../src/query_part.js"],"names":["register","options","index","type","QueryPartDef","category","push","aliasRenderer","part","innerExpr","params","addAliasStrategy","selectParts","partModel","partCount","length","def","selectmenu","AS","replaceAggregationAddStrategy","i","Aggregations","splice","addMathStrategy","Math","addFieldStrategy","query","select","fieldRenderer","createPart","message","QueryPart","orderByRenderer","toUpperCase","_","functionRenderer","suffixRenderer","identityRenderer","quotedIdentityRenderer","name","Fields","ordermenu","ORDER","addStrategy","quote","defaultParams","renderMode","renderer","dynamicLookup","groupByTimeFunctions","create","getSelectMenu","reduce","memo","cat","key","menu","text","submenu","map","item","value","getOrderMenu","concat","getCategory"],"mappings":"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","file":"query_part.js","sourcesContent":["///<reference path=\"../../../headers/common.d.ts\" />\n\nimport _ from 'lodash';\nimport {\n  QueryPartDef,\n  QueryPart,\n  functionRenderer,       // 函数渲染\n  suffixRenderer,         // 后缀渲染\n  identityRenderer,       // 正常渲染\n  quotedIdentityRenderer, // 引号渲染\n} from 'app/core/components/query_part/query_part';\n\n\nvar index = [];\n\n// 用于生成Select菜单\nvar selectmenu = {\n\t  AS: {name:'重命名',category:[]},              // 别名\n\t  Math: {name:'算术函数',category:[]},          // 算术\n\t  Fields: {name:'新增字段',category:[]},        // 字段\n\t  Aggregations: {name:'聚合函数',category:[]},  // 聚合\n};\n\n// 用于生成Order菜单\nvar ordermenu={\n\tORDER:{name:'排序',category:[]}\n}\n\n// 注册函数\nfunction register(options) {\n  index[options.type] = new QueryPartDef(options);\n  options.category.push(index[options.type]);\n}\n\n\n//======================\n// as\n//======================\n// AS渲染\nfunction aliasRenderer(part, innerExpr) {\n  return innerExpr + ' AS '+ part.params[0];\n}\n// AS策略\nfunction addAliasStrategy(selectParts, partModel) {\n  var partCount = selectParts.length;\n  if (partCount > 0) {\n    // 如果selectPart,最后一个alias操作;则替换成当前订的partModel\n    if (selectParts[partCount-1].def.category === selectmenu.AS.category) {\n      selectParts[partCount-1] = partModel;\n      return;\n    }\n  }\n  // 执行追加操作\n  selectParts.push(partModel);\n}\n// 自定义别名\nregister({\n  type: 'as',\n  addStrategy: addAliasStrategy,\n  category: selectmenu.AS.category,\n  params: [{ name: \"name\", type: \"string\", quote: 'double'}],\n  defaultParams: ['name'],\n  renderMode: 'suffix',\n  renderer: aliasRenderer\n});\n// x轴\nregister({\n  type: 'X轴',\n  addStrategy: addAliasStrategy,\n  category: selectmenu.AS.category,\n  params: [{ name: \"name\", type: \"string\", quote: 'double'}],\n  defaultParams: ['X'],\n  renderMode: 'suffix',\n  renderer: function(part, innerExpr){\n  \treturn innerExpr + ' AS x';\n  }\n});\n// y轴\nregister({\n  type: 'Y轴',\n  addStrategy: addAliasStrategy,\n  category: selectmenu.AS.category,\n  params: [{ name: \"name\", type: \"string\", quote: 'double'}],\n  defaultParams: ['Y'],\n  renderMode: 'suffix',\n  renderer: function(part, innerExpr){\n  \treturn innerExpr + ' AS y';\n  }\n});\n// 作为图例\nregister({\n  type: '图例',\n  addStrategy: addAliasStrategy,\n  category: selectmenu.AS.category,\n  params: [{ name: \"name\", type: \"string\", quote: 'double'}],\n  defaultParams: ['legend'],\n  renderMode: 'suffix',\n  renderer: function(part, innerExpr){\n  \treturn innerExpr + ' AS legend';\n  }\n});\n\n\n\n//======================\n// aggregation\n//======================\n\n// 聚合策略\nfunction replaceAggregationAddStrategy(selectParts, partModel) {\n  // 查找现存的selectPart,然后替换最新的函数操作\n  for (var i = 0; i < selectParts.length; i++) {\n    var part = selectParts[i];\n    // 如果是聚合函数\n    if (part.def.category === selectmenu.Aggregations.category) {\n      selectParts[i] = partModel;\n      return;\n    }\n  }\n\t// 执行替换操作\n  selectParts.splice(1, 0, partModel);\n}\n// 最大值\nregister({\n  type: 'max',\n  addStrategy: replaceAggregationAddStrategy,\n  category: selectmenu.Aggregations.category,\n  params: [],\n  defaultParams: [],\n  renderer: functionRenderer,\n});\n// 最小值\nregister({\n  type: 'min',\n  addStrategy: replaceAggregationAddStrategy,\n  category: selectmenu.Aggregations.category,\n  params: [],\n  defaultParams: [],\n  renderer: functionRenderer,\n});\n\n// 求和\nregister({\n  type: 'sum',\n  addStrategy: replaceAggregationAddStrategy,\n  category: selectmenu.Aggregations.category,\n  params: [],\n  defaultParams: [],\n  renderer: functionRenderer,\n});\n// 计数 \nregister({\n  type: 'count',\n  addStrategy: replaceAggregationAddStrategy,\n  category: selectmenu.Aggregations.category,\n  params: [],\n  defaultParams: [],\n  renderer: functionRenderer,\n});\n// 唯一\nregister({\n  type: 'distinct',\n  addStrategy: replaceAggregationAddStrategy,\n  category: selectmenu.Aggregations.category,\n  params: [],\n  defaultParams: [],\n  renderer: functionRenderer,\n});\n\n//======================\n// math\n//======================\n// 算术策略\nfunction addMathStrategy(selectParts, partModel) {\n  var partCount = selectParts.length;\n  if (partCount > 0) {\n    // if last is math, replace it\n    if (selectParts[partCount-1].def.category === selectmenu.Math.category) {\n      selectParts[partCount-1] = partModel;\n      return;\n    }\n    // if next to last is math, replace it\n    if ( partCount>1 && (selectParts[partCount-2].def.category === selectmenu.Math.category)) {\n      selectParts[partCount-2] = partModel;\n      return;\n    } else if (selectParts[partCount-1].def.category === selectmenu.AS.category) { // if last is alias add it before\n      selectParts.splice(partCount-1, 0, partModel);\n      return;\n    }\n  }\n  selectParts.push(partModel);\n}\nregister({\n  type: 'math',\n  addStrategy: addMathStrategy,\n  category: selectmenu.Math.category,\n  params: [{ name: \"expr\", type: \"string\"}],\n  defaultParams: [' / 100'],\n  renderer: suffixRenderer,\n});\n\n\n//======================\n// field\n//======================\n// 字段策略\nfunction addFieldStrategy(selectParts, partModel, query) {\n\t// 追加到OrderModels中\n  query.select.push([partModel]);\n}\n//字段渲染\nfunction fieldRenderer(part, innerExpr) {\n  if (part.params[0] === '*')  {\n    return '*';\n  }\n  return part.params[0];\n}\nregister({\n  type: 'field',\n  addStrategy: addFieldStrategy,\n  category: selectmenu.Fields.category,\n  params: [{type: 'field', dynamicLookup: true}],\n  defaultParams: ['value'],\n  renderer: fieldRenderer,\n});\n\n// 创建新的Part\nfunction createPart(part) {\n  var def = index[part.type];\n  if (!def) {\n    throw {message: 'Could not find query part ' + part.type};\n  }\n\n  return new QueryPart(part, def);\n};\n\n\n\n//======================\n// group\n//======================\nvar groupByTimeFunctions = [];\nregister({\n  type: 'time',\n  category: groupByTimeFunctions,\n  params: [{ name: \"interval\", type: \"time\", options: ['auto', '1s', '10s', '1m', '5m', '10m', '15m', '1h'] }],\n  defaultParams: ['auto'],\n  renderer: functionRenderer,\n});\n\nregister({\n  type: 'fill',\n  category: groupByTimeFunctions,\n  params: [{ name: \"fill\", type: \"string\", options: ['none', 'null', '0', 'previous'] }],\n  defaultParams: ['null'],\n  renderer: functionRenderer,\n});\nregister({\n  type: 'tag',\n  category: groupByTimeFunctions,\n  params: [{name: 'tag', type: 'string', dynamicLookup: true}],\n  defaultParams: ['tag'],\n  renderer: fieldRenderer,\n});\n\n//======================\n// order\n//======================\n//字段渲染\nfunction orderByRenderer(part, innerExpr) {\n  return  part.params[0] + ' '+ part.def.type.toUpperCase();\n}\nregister({\n  type: 'desc',\n  category: ordermenu.ORDER.category,\n  params: [{ name: \"desc\", type: \"string\",dynamicLookup: true}],\n  defaultParams: ['field'],\n  renderer: orderByRenderer,\n});\n\nregister({\n  type: 'asc',\n  category: ordermenu.ORDER.category,\n  params: [{ name: \"asc\", type: \"string\",dynamicLookup: true}],\n  defaultParams: ['field'],\n  renderer: orderByRenderer,\n});\n\n\n\n\nexport default {\n  create: createPart,\n  getSelectMenu: function() {\n    return _.reduce(selectmenu, function(memo, cat, key) {\n\t\t\t\t\t\t\tvar menu = {\n\t\t\t\t\t\t\t\ttext: cat.name||key,\n\t\t\t\t\t\t\t\tsubmenu: cat.category.map(item => {\n\t\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\t\ttext: item.type,\n\t\t\t\t\t\t\t\t\t\tvalue: item.type\n\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tmemo.push(menu);\n\t\t\t\t\t\t\treturn memo;\n\t\t\t\t\t\t}, []);\n\t\t\n  },\n  getOrderMenu: function(){\n  \treturn _.reduce(ordermenu, function(memo, cat, key) {\n\t\t\t\t\t\t\tvar menu = cat.category.map(item => {\n\t\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\t\ttext: item.type,\n\t\t\t\t\t\t\t\t\t\tvalue: item.type\n\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tmemo=memo.concat(menu);\n\t\t\t\t\t\t\treturn memo;\n\t\t\t\t\t\t}, []);\n  },\n  getCategory:function(){\n  \treturn selectmenu;\n  }\n  \n};\n"]}